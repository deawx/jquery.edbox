/*
* jQuery Edbox plugin v.2.2.0
* @author Eduardo Moreno - eduardocmoreno[at]gmail[dot]com
* Code under MIT License - http://en.wikipedia.org/wiki/MIT_License
*/
!function(e,o,t){function n(n,a){t=this,t.opt=e.extend({},o,n),t.$el=e(a),t.attr={target:t.$el.attr("data-box-target"),html:t.$el.attr("data-box-html"),image:t.$el.attr("data-box-image"),url:t.$el.attr("data-box-url"),header:t.$el.attr("data-box-header"),footer:t.$el.attr("data-box-footer")},t.target=t.opt.target||t.attr.target,t.html=t.opt.html||t.attr.html,t.image=t.opt.image||t.attr.image,t.url=t.opt.url||t.$el.attr("href")||t.attr.url,t.$box=e('<div class="edbox"/>'),t.$boxError=e('<div class="edbox-error"/>'),t.$boxLoad=e('<div class="edbox-load"/>'),t.$boxBody=e('<div class="edbox-body"/>'),t.$boxClose=e('<div class="edbox-close"/>'),t.$boxContent=e('<div class="edbox-content"/>'),t.$boxHeader=e('<div class="edbox-header"/>'),t.$boxFooter=e('<div class="edbox-footer"/>'),t.$boxTemp=e('<div class="edbox-temp"/>'),t.animateEvents="webkitAnimationEnd oanimationend msAnimationEnd animationend",t.init()}n.prototype={init:function(){t.base();var o=t.target||t.html||t.image||t.url,n=t.opt.success&&"success"||t.opt.info&&"info"||t.opt.warning&&"warning"||t.opt.danger&&"danger";if(!o&&!n)return void t.alert("danger","Undefined");if(t.opt.beforeOpen(),t.target){var a=e(t.target);return void(a.length?(a.after(t.$boxTemp).addClass("edbox-target"),t.insert(a)):t.alert("danger",'Unable to find element: "'+t.target+'"'))}return t.html?void t.insert(t.html):t.image?(t.imageObj=new Image,t.imageObj.src=t.image,void(t.imageObj.complete?t.insert(t.imageObj):t.load.start(t.image))):t.url?void t.load.start(t.url):n?void t.alert(n,t.opt[n]):void 0},base:function(){t.$box.addClass(t.opt.addClass).add(t.opt.close&&t.$boxClose).on("click",t.events.click),e("body").prepend(t.$box),e(window).on("keydown",t.events.keydown)},alert:function(o,n){t.$box.addClass("edbox-alert edbox-alert-"+o).append(e("<div/>").addClass("edbox-alert-container").append("<div>"+n+"</div>",t.opt.close&&t.$boxClose)),t.toggle("open")},insert:function(o){var n=t.attr.header||t.opt.header,a=t.attr.footer||t.opt.footer;t.opt.close&&n&&t.$boxHeader.append(t.$boxClose),t.$box.append(t.$boxBody.css({width:t.opt.width,height:t.opt.height}).append(n&&t.$boxHeader.append(t.attr.header||t.opt.header),t.opt.close&&!n&&t.$boxClose,t.$boxContent.append(o),a&&t.$boxFooter.append(t.attr.footer||t.opt.footer))),t.toggle("open"),e(window).on("resize",t.events.resize).resize()},toggle:function(e,o){"close"==e&&!t.loading&&!t.responseError&&t.opt.beforeClose(),t.opt.animation?t.$box.children().addClass("open"==e?t.opt.animateOpen:t.opt.animateClose).one(t.animateEvents,function(){"function"==typeof o?o():t.callback[e]()}):"function"==typeof o?o():t.callback[e]()},load:{start:function(o){t.loading=!0,t.$box.append(t.$boxLoad),t.toggle("open",function(){t.urlLoad=e.ajax({url:o,cache:!t.image}).fail(function(e){t.responseError=!0,t.load.complete("error",(t.image||t.url)+" "+e.statusText.toLowerCase())}).done(function(e){t.load.complete("insert",null,t.imageObj||e)})})},complete:function(e,o,n){t.toggle("close",function(){t.loading=!1,t.$boxLoad.remove(),"error"==e?t.alert("danger",o):t[e](n)})}},events:{click:function(e){t.opt.close&&e.target==e.currentTarget&&t.toggle("close")},keydown:function(e){t.opt.close&&27==e.which&&t.toggle("close")},resize:function(){var e=t.$boxBody.outerHeight(),o=t.$boxHeader.outerHeight(),n=t.$boxFooter.outerHeight(),a=t.$boxContent.get(0).scrollHeight,r=Math.ceil(e-(o+n))<a;t.$boxBody[r?"addClass":"removeClass"]("edbox-scroll-true")}},callback:{open:function(){!t.responseError&&t.opt.afterOpen()},close:function(){e(window).off({keydown:t.events.keydown,resize:t.events.resize}),!t.responseError&&e(t.target).removeClass("edbox-helper-class").appendTo(t.$boxTemp).unwrap(),t.loading&&t.urlLoad.abort(),t.$box.remove(),e.removeData(window,"edbox"),!t.loading&&!t.responseError&&t.opt.afterClose()}}},e.edboxSettings=function(t){return e.extend(o,t)},e.edbox=function(o,t){var a=e.data(window,"edbox");return"close"==o&&a?void a.toggle("close"):"object"!=typeof o&&!e(t).length||a?void 0:void e.data(window,"edbox",new n(o,t))},e.fn.edbox=function(o){return this.each(function(){e(this).on("click",function(t){t.preventDefault(),e.edbox(o,this)})})}}(jQuery,{target:null,html:null,image:null,url:null,success:null,info:null,warning:null,danger:null,header:null,footer:null,width:null,height:null,addClass:null,close:!0,animation:!0,animateOpen:"edbox-animate-open",animateClose:"edbox-animate-close",beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}});